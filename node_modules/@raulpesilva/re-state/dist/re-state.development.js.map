{"version":3,"file":"re-state.development.js","sources":["../src/core/batch.ts","../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelperLoose.js","../src/core/listener.ts","../src/core/observer.ts","../node_modules/@babel/runtime/helpers/esm/extends.js","../src/core/utils.ts","../src/core/store.ts","../src/react/store.ts","../src/react/createGetReState.ts","../src/react/useIsomorphicLayoutEffect.ts","../src/react/useReState.ts","../src/react/createReState.ts","../src/react/createReStateDispatch.ts","../src/react/createReStateSelect.ts","../src/react/createReStateMethods.ts","../src/react/onReStateChange.ts","../src/react/utils.ts","../src/react/useReStateSelector.ts"],"sourcesContent":["//inspired by react redux\nfunction defaultNoopBatch(callback: any) {\n  callback();\n}\n\nlet batch = defaultNoopBatch;\nexport const setBatch = (newBatch: any) => (batch = newBatch);\n\nexport const getBatch = () => batch;\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","import unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nexport default function _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n\n  if (Array.isArray(o) || (it = unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import type { CompareStore, FnVoid } from './types';\n\nexport class Listener {\n  _listeners: CompareStore[] = [];\n\n  subscribe(listener: CompareStore): FnVoid {\n    this._listeners.push(listener);\n    return (): void => {\n      const index = this._listeners.indexOf(listener);\n      if (index < 0) return;\n      this._listeners[index] = this._listeners[this._listeners.length - 1] as CompareStore;\n      this._listeners.length--;\n    };\n  }\n\n  notify(prevStore: any, newStore: any): void {\n    for (const listener of this._listeners) {\n      listener(prevStore, newStore);\n    }\n  }\n}\n","import type { FnVoid, UniqueKey } from './types';\n\nexport class Observer {\n  _listeners = new Map();\n\n  subscribe(key: UniqueKey, listener: FnVoid): FnVoid {\n    if (this._listeners.has(key)) {\n      const listeners = this._listeners.get(key);\n      this._listeners.set(key, [...listeners, listener]);\n    }\n\n    if (!this._listeners.has(key)) {\n      this._listeners.set(key, [listener]);\n    }\n\n    return (): void => {\n      const listenersCopy = [...this._listeners.get(key)];\n      const index = this._listeners.get(key).indexOf(listener);\n      if (index < 0) return;\n      listenersCopy[index] = listenersCopy[listenersCopy.length - 1];\n      listenersCopy.length--;\n      this._listeners.set(key, listenersCopy);\n    };\n  }\n\n  notify(key: UniqueKey): void {\n    if (this._listeners.has(key)) {\n      for (const listener of this._listeners.get(key)) {\n        listener();\n      }\n    }\n  }\n}\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","/*eslint-disable no-self-compare */\nexport const isFunction = (data: any) => {\n  return typeof data === 'function';\n};\n","import type { UniqueKey, FnVoid } from './types';\nimport { isFunction } from './utils';\nimport { getBatch } from './batch';\nimport { Listener } from './listener';\nimport { Observer } from './observer';\n\nexport class Store {\n  __store = new Map<UniqueKey, unknown>();\n  __initial_store = new Map<UniqueKey, unknown>();\n  __observer = new Observer();\n  __listener = new Listener();\n\n  static convertStoreToObject(receivedStore: Map<UniqueKey, unknown>) {\n    const obj = Object.fromEntries(receivedStore.entries());\n    return obj;\n  }\n\n  static getStoreKeys(store: Map<UniqueKey, unknown>): UniqueKey[] {\n    return Array.from(store.keys());\n  }\n\n  get<S = undefined>(key: UniqueKey) {\n    return this.__store.get(key) as S;\n  }\n\n  getMany<T>(fn: (state: any) => T) {\n    if (!isFunction(fn)) {\n      throw new TypeError(\n        'to select a value in the store it is necessary to pass a function - ex: (store) => store.myKey'\n      );\n    }\n    const objectStore = Store.convertStoreToObject(this.__store);\n    return fn(objectStore);\n  }\n\n  _set<S>(key: UniqueKey, newValue: S): void {\n    const hasKey = this.__store.has(key);\n    if (typeof newValue === 'function') {\n      const prevValue = this.get<S>(key);\n      const value = newValue(prevValue);\n      this.__store.set(key, value);\n      if (!hasKey) this.setInitialValue(key, value);\n    } else {\n      this.__store.set(key, newValue);\n      if (!hasKey) this.setInitialValue(key, newValue);\n    }\n  }\n\n  set<S>(key: UniqueKey, newValue: S): void {\n    const { ...prevStore } = Store.convertStoreToObject(this.__store);\n\n    this._set(key, newValue);\n\n    const { ...newStore } = Store.convertStoreToObject(this.__store);\n\n    const batch = getBatch();\n    batch(() => {\n      this.notify(key);\n      this.notifySelectors(prevStore, newStore);\n    });\n  }\n\n  setWithoutNotify<S>(key: UniqueKey, newValue: S): void {\n    this._set(key, newValue);\n  }\n\n  setInitialValue<S>(key: UniqueKey, value: S) {\n    this.__initial_store.set(key, value);\n  }\n\n  has(key: UniqueKey) {\n    return this.__store.has(key);\n  }\n\n  notifySelectors(prevStore: any, newStore: any) {\n    this.__listener.notify(prevStore, newStore);\n  }\n\n  subscribeSelector(listener: (prevStore: any, newStore: any) => void) {\n    return this.__listener.subscribe(listener);\n  }\n\n  subscribe(key: UniqueKey, listener: FnVoid) {\n    return this.__observer.subscribe(key, listener);\n  }\n\n  notify(key: UniqueKey) {\n    this.__observer.notify(key);\n  }\n\n  reset() {\n    this.__store = new Map(this.__initial_store.entries());\n    const keys = Store.getStoreKeys(this.__store);\n    const batch = getBatch();\n    const newStore = Store.convertStoreToObject(this.__store);\n    batch(() => {\n      keys.forEach((key) => {\n        this.notify(key);\n        this.notifySelectors(undefined, newStore);\n      });\n    });\n  }\n}\n","import type { UniqueKey } from '../core';\nimport { Store } from '../core/store';\n\nexport const store = new Store();\nexport const resetReState = () => store.reset();\nexport const setReStateInitialValue = (key: UniqueKey, value: any) => store.setInitialValue(key, value);","import type { UniqueKey } from '../core/types';\nimport { store } from './store';\n\nexport function createGetReState<S>(key: UniqueKey) {\n  return (): S => store.get(key);\n}\n","import { useEffect, useLayoutEffect } from 'react'\n\nexport const useIsomorphicLayoutEffect =\n  typeof window !== 'undefined' &&\n  typeof window.document !== 'undefined' &&\n  typeof window.document.createElement !== 'undefined'\n    ? useLayoutEffect\n    : useEffect\n","import { useCallback, useDebugValue, useState } from 'react';\nimport type { UniqueKey, SetReStateAction } from '../core/types';\nimport { store } from './store';\nimport type { DispatchReState } from './types';\nimport { useIsomorphicLayoutEffect } from './useIsomorphicLayoutEffect';\n\nexport function useReState<S>(\n  key: UniqueKey,\n  initialValue?: SetReStateAction<S>\n): [S, DispatchReState<SetReStateAction<S>>] {\n  const makeState = useCallback(\n    (value: SetReStateAction<S>): S => {\n      if (store.has(key)) {\n        return store.get<S>(key);\n      } else {\n        store.setWithoutNotify<SetReStateAction<S>>(key, value);\n        return store.get<S>(key);\n      }\n    },\n    [key]\n  );\n\n  const setState = useCallback(\n    (newValue: SetReStateAction<S>) => {\n      store.set<SetReStateAction<S>>(key, newValue);\n    },\n    [key]\n  );\n\n  const [reStateValue, setReStateValue] = useState<S>(makeState(initialValue));\n\n  useDebugValue(makeState(initialValue));\n\n  useIsomorphicLayoutEffect(() => {\n    const unSub = store.subscribe(key, () => {\n      setReStateValue(store.get(key));\n    });\n\n    return unSub;\n  }, [initialValue, key]);\n\n  return [reStateValue, setState];\n}\n\nuseReState.displayName = 'useReState';\n","import type { SetReStateAction, UniqueKey } from '../core/types';\nimport { store } from './store';\nimport type { DispatchReState } from './types';\nimport { useReState } from './useReState';\n\nexport function createReState<S>(key: UniqueKey, initialValue?: SetReStateAction<S>) {\n  store.setWithoutNotify(key, initialValue);\n  return function useCreatedUseReState(): [S, DispatchReState<SetReStateAction<S>>] {\n    return useReState<S>(key);\n  };\n}\n","import type { UniqueKey, SetReStateAction } from '../core/types';\nimport { store } from './store';\n\nexport function createReStateDispatch<S>(key: UniqueKey) {\n  return (value: SetReStateAction<S>) => store.set(key, value);\n}\n","import { useDebugValue, useState } from 'react';\nimport type { UniqueKey } from '../core/types';\nimport { store } from './store';\nimport { useIsomorphicLayoutEffect } from './useIsomorphicLayoutEffect';\n\nexport function createReStateSelect<S>(key: UniqueKey) {\n  return function useReStateSelect() {\n    const [reStateValue, setReStateValue] = useState<S>(store.get(key));\n\n    useDebugValue(reStateValue);\n\n    useIsomorphicLayoutEffect(() => {\n      const unSub = store.subscribe(key, () => {\n        setReStateValue(store.get(key));\n      });\n\n      return unSub;\n    }, [key]);\n\n    return reStateValue;\n  };\n}\n","import { SetReStateAction } from '../core';\nimport { createGetReState } from './createGetReState';\nimport { createReState } from './createReState';\nimport { createReStateDispatch } from './createReStateDispatch';\nimport { createReStateSelect } from './createReStateSelect';\nimport { setReStateInitialValue } from './store';\nimport { DispatchReState } from './types';\n\ntype useReState<S extends string, V> = Record<`use${Capitalize<S>}`, () => [V, DispatchReState<SetReStateAction<V>>]>;\ntype useReStateSelect<S extends string, V> = Record<`use${Capitalize<S>}Select`, () => V>;\ntype dispatchReState<S extends string, V> = Record<`dispatch${Capitalize<S>}`, DispatchReState<SetReStateAction<V>>>;\ntype getReState<S extends string, V> = Record<`get${Capitalize<S>}`, () => V>;\ntype resetReState<S extends string> = Record<`reset${Capitalize<S>}`, () => void>;\n\ntype ReStateMethods<T extends string, S> = useReState<T, S> &\n  useReStateSelect<T, S> &\n  dispatchReState<T, S> &\n  getReState<T, S> &\n  resetReState<T>;\n\n/**\n * Creates a set of methods to use with React.\n * @param name Unique name of the state\n * @param initialValue initial value of the state\n * @param valueOfReset value to reset when calling resetReState\n * @returns a set of methods to use with React\n */\nexport const createReStateMethods = <S extends string = string, V extends any = any>(\n  name: S,\n  initialValue?: V,\n  valueOfReset?: { value: V }\n): { [K in keyof ReStateMethods<S, V>]: ReStateMethods<S, V>[K] } => {\n  if (!name) throw new Error('Name is required');\n  if (typeof name !== 'string') throw new Error('Name need to be a string');\n\n  const capitalizedName = name.charAt(0).toUpperCase() + name.slice(1);\n\n  const use = createReState<V>(name, initialValue);\n  const useSelect = createReStateSelect<V>(name);\n  const dispatch = createReStateDispatch<V>(name);\n  const get = createGetReState<V>(name);\n  if (valueOfReset) setReStateInitialValue(name, valueOfReset.value);\n\n  const methods = {\n    [`use${capitalizedName}`]: use,\n    [`use${capitalizedName}Select`]: useSelect,\n    [`dispatch${capitalizedName}`]: dispatch,\n    [`get${capitalizedName}`]: get,\n    [`reset${capitalizedName}`]: () => dispatch(valueOfReset?.value ?? initialValue),\n  } as ReStateMethods<S, V>;\n\n  return methods;\n};\n","import { FnVoid, UniqueKey } from '../core';\nimport { store } from './store';\n\nexport const onReStateChange = (callback: FnVoid, dependencies: UniqueKey[]) => {\n  dependencies.forEach((dependency) => store.subscribe(dependency, callback));\n};\n","var hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction is(x: unknown, y: unknown) {\n  if (x === y) {\n    return x !== 0 || y !== 0 || 1 / x === 1 / y;\n  } else {\n    return x !== x && y !== y;\n  }\n}\n\nexport function shallowEqual(objA: any, objB: any) {\n  if (is(objA, objB)) {\n    return true;\n  }\n\n  if (typeof objA !== 'object' || objA === null || typeof objB !== 'object' || objB === null) {\n    return false;\n  }\n\n  const keysA = Object.keys(objA);\n  const keysB = Object.keys(objB);\n\n  if (keysA.length !== keysB.length) return false;\n\n  for (let i = 0; i < keysA.length; i++) {\n    if (!hasOwnProperty.call(objB, keysA[i] as string) || !is(objA[keysA[i] as string], objB[keysA[i] as string])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import { useDebugValue, useState } from 'react';\nimport { shallowEqual } from './utils';\nimport { store } from './store';\nimport type { Selector } from './types';\nimport { useIsomorphicLayoutEffect } from './useIsomorphicLayoutEffect';\n\nexport function useReStateSelector<T, S = T>(selector: Selector<T, S>, isEquals = shallowEqual): S {\n  const [selectorValue, setSelectorValue] = useState<S>(store.getMany(selector));\n\n  useDebugValue(selectorValue);\n\n  useIsomorphicLayoutEffect(() => {\n    const unSub = store.subscribeSelector((prevStore: T, newStore: T) => {\n      const prevSelection = selector(prevStore);\n      const newSelection = selector(newStore);\n      if (!isEquals(prevSelection, newSelection)) {\n        setSelectorValue(newSelection);\n      }\n    });\n\n    return unSub;\n  }, [selector]);\n\n  return selectorValue;\n}\n"],"names":["defaultNoopBatch","callback","batch","getBatch","_arrayLikeToArray","arr","len","length","i","arr2","Array","_unsupportedIterableToArray","o","minLen","arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","from","test","_createForOfIteratorHelperLoose","allowArrayLike","it","Symbol","iterator","next","bind","isArray","unsupportedIterableToArray","done","value","TypeError","Listener","_listeners","subscribe","listener","push","index","indexOf","notify","prevStore","newStore","Observer","Map","key","has","listeners","get","set","listenersCopy","_extends","assign","target","arguments","source","hasOwnProperty","apply","isFunction","data","Store","__store","__initial_store","__observer","__listener","convertStoreToObject","receivedStore","obj","fromEntries","entries","getStoreKeys","store","keys","getMany","fn","objectStore","_set","newValue","hasKey","prevValue","setInitialValue","notifySelectors","setWithoutNotify","subscribeSelector","reset","forEach","undefined","resetReState","setReStateInitialValue","createGetReState","useIsomorphicLayoutEffect","window","document","createElement","useLayoutEffect","useEffect","useReState","initialValue","makeState","useCallback","setState","useState","reStateValue","setReStateValue","useDebugValue","unSub","displayName","createReState","useCreatedUseReState","createReStateDispatch","createReStateSelect","useReStateSelect","createReStateMethods","valueOfReset","Error","capitalizedName","charAt","toUpperCase","use","useSelect","dispatch","methods","onReStateChange","dependencies","dependency","is","x","y","shallowEqual","objA","objB","keysA","keysB","useReStateSelector","selector","isEquals","selectorValue","setSelectorValue","prevSelection","newSelection"],"mappings":";;;;;;EAAA;EACA,SAASA,gBAAT,CAA0BC,QAA1B,EAAyC;EACvCA,EAAAA,QAAQ;EACT;;EAED,IAAIC,KAAK,GAAGF,gBAAZ;EAGO,IAAMG,QAAQ,GAAG,SAAXA,QAAW;EAAA,SAAMD,KAAN;EAAA,CAAjB;;ECRQ,SAASE,iBAAT,CAA2BC,GAA3B,EAAgCC,GAAhC,EAAqC;EAClD,MAAIA,GAAG,IAAI,IAAP,IAAeA,GAAG,GAAGD,GAAG,CAACE,MAA7B,EAAqCD,GAAG,GAAGD,GAAG,CAACE,MAAV;;EAErC,OAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,IAAI,GAAG,IAAIC,KAAJ,CAAUJ,GAAV,CAAvB,EAAuCE,CAAC,GAAGF,GAA3C,EAAgDE,CAAC,EAAjD,EAAqD;EACnDC,IAAAA,IAAI,CAACD,CAAD,CAAJ,GAAUH,GAAG,CAACG,CAAD,CAAb;EACD;;EAED,SAAOC,IAAP;EACD;;ECPc,SAASE,2BAAT,CAAqCC,CAArC,EAAwCC,MAAxC,EAAgD;EAC7D,MAAI,CAACD,CAAL,EAAQ;EACR,MAAI,OAAOA,CAAP,KAAa,QAAjB,EAA2B,OAAOE,iBAAgB,CAACF,CAAD,EAAIC,MAAJ,CAAvB;EAC3B,MAAIE,CAAC,GAAGC,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BP,CAA/B,EAAkCQ,KAAlC,CAAwC,CAAxC,EAA2C,CAAC,CAA5C,CAAR;EACA,MAAIL,CAAC,KAAK,QAAN,IAAkBH,CAAC,CAACS,WAAxB,EAAqCN,CAAC,GAAGH,CAAC,CAACS,WAAF,CAAcC,IAAlB;EACrC,MAAIP,CAAC,KAAK,KAAN,IAAeA,CAAC,KAAK,KAAzB,EAAgC,OAAOL,KAAK,CAACa,IAAN,CAAWX,CAAX,CAAP;EAChC,MAAIG,CAAC,KAAK,WAAN,IAAqB,2CAA2CS,IAA3C,CAAgDT,CAAhD,CAAzB,EAA6E,OAAOD,iBAAgB,CAACF,CAAD,EAAIC,MAAJ,CAAvB;EAC9E;;ECPc,SAASY,+BAAT,CAAyCb,CAAzC,EAA4Cc,cAA5C,EAA4D;EACzE,MAAIC,EAAE,GAAG,OAAOC,MAAP,KAAkB,WAAlB,IAAiChB,CAAC,CAACgB,MAAM,CAACC,QAAR,CAAlC,IAAuDjB,CAAC,CAAC,YAAD,CAAjE;EACA,MAAIe,EAAJ,EAAQ,OAAO,CAACA,EAAE,GAAGA,EAAE,CAACR,IAAH,CAAQP,CAAR,CAAN,EAAkBkB,IAAlB,CAAuBC,IAAvB,CAA4BJ,EAA5B,CAAP;;EAER,MAAIjB,KAAK,CAACsB,OAAN,CAAcpB,CAAd,MAAqBe,EAAE,GAAGM,2BAA0B,CAACrB,CAAD,CAApD,KAA4Dc,cAAc,IAAId,CAAlB,IAAuB,OAAOA,CAAC,CAACL,MAAT,KAAoB,QAA3G,EAAqH;EACnH,QAAIoB,EAAJ,EAAQf,CAAC,GAAGe,EAAJ;EACR,QAAInB,CAAC,GAAG,CAAR;EACA,WAAO,YAAY;EACjB,UAAIA,CAAC,IAAII,CAAC,CAACL,MAAX,EAAmB,OAAO;EACxB2B,QAAAA,IAAI,EAAE;EADkB,OAAP;EAGnB,aAAO;EACLA,QAAAA,IAAI,EAAE,KADD;EAELC,QAAAA,KAAK,EAAEvB,CAAC,CAACJ,CAAC,EAAF;EAFH,OAAP;EAID,KARD;EASD;;EAED,QAAM,IAAI4B,SAAJ,CAAc,uIAAd,CAAN;EACD;;MClBYC,QAAb;EAAA;EAAA,SACEC,UADF,GAC+B,EAD/B;EAAA;;EAAA;;EAAA,SAGEC,SAHF,GAGE,mBAAUC,QAAV,EAA0C;EAAA;;EACxC,SAAKF,UAAL,CAAgBG,IAAhB,CAAqBD,QAArB;;EACA,WAAO,YAAY;EACjB,UAAME,KAAK,GAAG,KAAI,CAACJ,UAAL,CAAgBK,OAAhB,CAAwBH,QAAxB,CAAd;;EACA,UAAIE,KAAK,GAAG,CAAZ,EAAe;EACf,MAAA,KAAI,CAACJ,UAAL,CAAgBI,KAAhB,IAAyB,KAAI,CAACJ,UAAL,CAAgB,KAAI,CAACA,UAAL,CAAgB/B,MAAhB,GAAyB,CAAzC,CAAzB;EACA,MAAA,KAAI,CAAC+B,UAAL,CAAgB/B,MAAhB;EACD,KALD;EAMD,GAXH;;EAAA,SAaEqC,MAbF,GAaE,gBAAOC,SAAP,EAAuBC,QAAvB,EAA4C;EAC1C,yDAAuB,KAAKR,UAA5B,wCAAwC;EAAA,UAA7BE,QAA6B;EACtCA,MAAAA,QAAQ,CAACK,SAAD,EAAYC,QAAZ,CAAR;EACD;EACF,GAjBH;;EAAA;EAAA;;MCAaC,QAAb;EAAA;EAAA,SACET,UADF,GACe,IAAIU,GAAJ,EADf;EAAA;;EAAA;;EAAA,SAGET,SAHF,GAGE,mBAAUU,GAAV,EAA0BT,QAA1B,EAAoD;EAAA;;EAClD,QAAI,KAAKF,UAAL,CAAgBY,GAAhB,CAAoBD,GAApB,CAAJ,EAA8B;EAC5B,UAAME,SAAS,GAAG,KAAKb,UAAL,CAAgBc,GAAhB,CAAoBH,GAApB,CAAlB;;EACA,WAAKX,UAAL,CAAgBe,GAAhB,CAAoBJ,GAApB,YAA6BE,SAA7B,GAAwCX,QAAxC;EACD;;EAED,QAAI,CAAC,KAAKF,UAAL,CAAgBY,GAAhB,CAAoBD,GAApB,CAAL,EAA+B;EAC7B,WAAKX,UAAL,CAAgBe,GAAhB,CAAoBJ,GAApB,EAAyB,CAACT,QAAD,CAAzB;EACD;;EAED,WAAO,YAAY;EACjB,UAAMc,aAAa,aAAO,KAAI,CAAChB,UAAL,CAAgBc,GAAhB,CAAoBH,GAApB,CAAP,CAAnB;;EACA,UAAMP,KAAK,GAAG,KAAI,CAACJ,UAAL,CAAgBc,GAAhB,CAAoBH,GAApB,EAAyBN,OAAzB,CAAiCH,QAAjC,CAAd;;EACA,UAAIE,KAAK,GAAG,CAAZ,EAAe;EACfY,MAAAA,aAAa,CAACZ,KAAD,CAAb,GAAuBY,aAAa,CAACA,aAAa,CAAC/C,MAAd,GAAuB,CAAxB,CAApC;EACA+C,MAAAA,aAAa,CAAC/C,MAAd;;EACA,MAAA,KAAI,CAAC+B,UAAL,CAAgBe,GAAhB,CAAoBJ,GAApB,EAAyBK,aAAzB;EACD,KAPD;EAQD,GArBH;;EAAA,SAuBEV,MAvBF,GAuBE,gBAAOK,GAAP,EAA6B;EAC3B,QAAI,KAAKX,UAAL,CAAgBY,GAAhB,CAAoBD,GAApB,CAAJ,EAA8B;EAC5B,2DAAuB,KAAKX,UAAL,CAAgBc,GAAhB,CAAoBH,GAApB,CAAvB,wCAAiD;EAAA,YAAtCT,QAAsC;EAC/CA,QAAAA,QAAQ;EACT;EACF;EACF,GA7BH;;EAAA;EAAA;;ECFe,SAASe,QAAT,GAAoB;EACjCA,EAAAA,QAAQ,GAAGvC,MAAM,CAACwC,MAAP,IAAiB,UAAUC,MAAV,EAAkB;EAC5C,SAAK,IAAIjD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGkD,SAAS,CAACnD,MAA9B,EAAsCC,CAAC,EAAvC,EAA2C;EACzC,UAAImD,MAAM,GAAGD,SAAS,CAAClD,CAAD,CAAtB;;EAEA,WAAK,IAAIyC,GAAT,IAAgBU,MAAhB,EAAwB;EACtB,YAAI3C,MAAM,CAACC,SAAP,CAAiB2C,cAAjB,CAAgCzC,IAAhC,CAAqCwC,MAArC,EAA6CV,GAA7C,CAAJ,EAAuD;EACrDQ,UAAAA,MAAM,CAACR,GAAD,CAAN,GAAcU,MAAM,CAACV,GAAD,CAApB;EACD;EACF;EACF;;EAED,WAAOQ,MAAP;EACD,GAZD;;EAcA,SAAOF,QAAQ,CAACM,KAAT,CAAe,IAAf,EAAqBH,SAArB,CAAP;EACD;;EChBD;EACO,IAAMI,UAAU,GAAG,SAAbA,UAAa,CAACC,IAAD,EAAe;EACvC,SAAO,OAAOA,IAAP,KAAgB,UAAvB;EACD,CAFM;;MCKMC,KAAb;EAAA;EAAA,SACEC,OADF,GACY,IAAIjB,GAAJ,EADZ;EAAA,SAEEkB,eAFF,GAEoB,IAAIlB,GAAJ,EAFpB;EAAA,SAGEmB,UAHF,GAGe,IAAIpB,QAAJ,EAHf;EAAA,SAIEqB,UAJF,GAIe,IAAI/B,QAAJ,EAJf;EAAA;;EAAA,QAMSgC,oBANT,GAME,8BAA4BC,aAA5B,EAAoE;EAClE,QAAMC,GAAG,GAAGvD,MAAM,CAACwD,WAAP,CAAmBF,aAAa,CAACG,OAAd,EAAnB,CAAZ;EACA,WAAOF,GAAP;EACD,GATH;;EAAA,QAWSG,YAXT,GAWE,sBAAoBC,KAApB,EAAiE;EAC/D,WAAOjE,KAAK,CAACa,IAAN,CAAWoD,KAAK,CAACC,IAAN,EAAX,CAAP;EACD,GAbH;;EAAA;;EAAA,SAeExB,GAfF,GAeE,aAAmBH,GAAnB,EAAmC;EACjC,WAAO,KAAKgB,OAAL,CAAab,GAAb,CAAiBH,GAAjB,CAAP;EACD,GAjBH;;EAAA,SAmBE4B,OAnBF,GAmBE,iBAAWC,EAAX,EAAkC;EAChC,QAAI,CAAChB,UAAU,CAACgB,EAAD,CAAf,EAAqB;EACnB,YAAM,IAAI1C,SAAJ,CACJ,gGADI,CAAN;EAGD;;EACD,QAAM2C,WAAW,GAAGf,KAAK,CAACK,oBAAN,CAA2B,KAAKJ,OAAhC,CAApB;EACA,WAAOa,EAAE,CAACC,WAAD,CAAT;EACD,GA3BH;;EAAA,SA6BEC,IA7BF,GA6BE,cAAQ/B,GAAR,EAAwBgC,QAAxB,EAA2C;EACzC,QAAMC,MAAM,GAAG,KAAKjB,OAAL,CAAaf,GAAb,CAAiBD,GAAjB,CAAf;;EACA,QAAI,OAAOgC,QAAP,KAAoB,UAAxB,EAAoC;EAClC,UAAME,SAAS,GAAG,KAAK/B,GAAL,CAAYH,GAAZ,CAAlB;EACA,UAAMd,KAAK,GAAG8C,QAAQ,CAACE,SAAD,CAAtB;;EACA,WAAKlB,OAAL,CAAaZ,GAAb,CAAiBJ,GAAjB,EAAsBd,KAAtB;;EACA,UAAI,CAAC+C,MAAL,EAAa,KAAKE,eAAL,CAAqBnC,GAArB,EAA0Bd,KAA1B;EACd,KALD,MAKO;EACL,WAAK8B,OAAL,CAAaZ,GAAb,CAAiBJ,GAAjB,EAAsBgC,QAAtB;;EACA,UAAI,CAACC,MAAL,EAAa,KAAKE,eAAL,CAAqBnC,GAArB,EAA0BgC,QAA1B;EACd;EACF,GAxCH;;EAAA,SA0CE5B,GA1CF,GA0CE,aAAOJ,GAAP,EAAuBgC,QAAvB,EAA0C;EAAA;;EACxC,gCAAyBjB,KAAK,CAACK,oBAAN,CAA2B,KAAKJ,OAAhC,CAAzB;EAAA,QAAWpB,SAAX;;EAEA,SAAKmC,IAAL,CAAU/B,GAAV,EAAegC,QAAf;;EAEA,iCAAwBjB,KAAK,CAACK,oBAAN,CAA2B,KAAKJ,OAAhC,CAAxB;EAAA,QAAWnB,QAAX;;EAEA,QAAM5C,KAAK,GAAGC,QAAQ,EAAtB;EACAD,IAAAA,KAAK,CAAC,YAAM;EACV,MAAA,KAAI,CAAC0C,MAAL,CAAYK,GAAZ;;EACA,MAAA,KAAI,CAACoC,eAAL,CAAqBxC,SAArB,EAAgCC,QAAhC;EACD,KAHI,CAAL;EAID,GAtDH;;EAAA,SAwDEwC,gBAxDF,GAwDE,0BAAoBrC,GAApB,EAAoCgC,QAApC,EAAuD;EACrD,SAAKD,IAAL,CAAU/B,GAAV,EAAegC,QAAf;EACD,GA1DH;;EAAA,SA4DEG,eA5DF,GA4DE,yBAAmBnC,GAAnB,EAAmCd,KAAnC,EAA6C;EAC3C,SAAK+B,eAAL,CAAqBb,GAArB,CAAyBJ,GAAzB,EAA8Bd,KAA9B;EACD,GA9DH;;EAAA,SAgEEe,GAhEF,GAgEE,aAAID,GAAJ,EAAoB;EAClB,WAAO,KAAKgB,OAAL,CAAaf,GAAb,CAAiBD,GAAjB,CAAP;EACD,GAlEH;;EAAA,SAoEEoC,eApEF,GAoEE,yBAAgBxC,SAAhB,EAAgCC,QAAhC,EAA+C;EAC7C,SAAKsB,UAAL,CAAgBxB,MAAhB,CAAuBC,SAAvB,EAAkCC,QAAlC;EACD,GAtEH;;EAAA,SAwEEyC,iBAxEF,GAwEE,2BAAkB/C,QAAlB,EAAqE;EACnE,WAAO,KAAK4B,UAAL,CAAgB7B,SAAhB,CAA0BC,QAA1B,CAAP;EACD,GA1EH;;EAAA,SA4EED,SA5EF,GA4EE,mBAAUU,GAAV,EAA0BT,QAA1B,EAA4C;EAC1C,WAAO,KAAK2B,UAAL,CAAgB5B,SAAhB,CAA0BU,GAA1B,EAA+BT,QAA/B,CAAP;EACD,GA9EH;;EAAA,SAgFEI,MAhFF,GAgFE,gBAAOK,GAAP,EAAuB;EACrB,SAAKkB,UAAL,CAAgBvB,MAAhB,CAAuBK,GAAvB;EACD,GAlFH;;EAAA,SAoFEuC,KApFF,GAoFE,iBAAQ;EAAA;;EACN,SAAKvB,OAAL,GAAe,IAAIjB,GAAJ,CAAQ,KAAKkB,eAAL,CAAqBO,OAArB,EAAR,CAAf;EACA,QAAMG,IAAI,GAAGZ,KAAK,CAACU,YAAN,CAAmB,KAAKT,OAAxB,CAAb;EACA,QAAM/D,KAAK,GAAGC,QAAQ,EAAtB;EACA,QAAM2C,QAAQ,GAAGkB,KAAK,CAACK,oBAAN,CAA2B,KAAKJ,OAAhC,CAAjB;EACA/D,IAAAA,KAAK,CAAC,YAAM;EACV0E,MAAAA,IAAI,CAACa,OAAL,CAAa,UAACxC,GAAD,EAAS;EACpB,QAAA,MAAI,CAACL,MAAL,CAAYK,GAAZ;;EACA,QAAA,MAAI,CAACoC,eAAL,CAAqBK,SAArB,EAAgC5C,QAAhC;EACD,OAHD;EAID,KALI,CAAL;EAMD,GA/FH;;EAAA;EAAA;;ECHO,IAAM6B,KAAK,GAAG,IAAIX,KAAJ,EAAd;MACM2B,YAAY,GAAG,SAAfA,YAAe;EAAA,SAAMhB,KAAK,CAACa,KAAN,EAAN;EAAA;MACfI,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAC3C,GAAD,EAAiBd,KAAjB;EAAA,SAAgCwC,KAAK,CAACS,eAAN,CAAsBnC,GAAtB,EAA2Bd,KAA3B,CAAhC;EAAA;;ECF/B,SAAS0D,gBAAT,CAA6B5C,GAA7B,EAA6C;EAClD,SAAO;EAAA,WAAS0B,KAAK,CAACvB,GAAN,CAAUH,GAAV,CAAT;EAAA,GAAP;EACD;;ECHM,IAAM6C,yBAAyB,GACpC,OAAOC,MAAP,KAAkB,WAAlB,IACA,OAAOA,MAAM,CAACC,QAAd,KAA2B,WAD3B,IAEA,OAAOD,MAAM,CAACC,QAAP,CAAgBC,aAAvB,KAAyC,WAFzC,GAGIC,qBAHJ,GAIIC,eALC;;ECIA,SAASC,UAAT,CACLnD,GADK,EAELoD,YAFK,EAGsC;EAC3C,MAAMC,SAAS,GAAGC,iBAAW,CAC3B,UAACpE,KAAD,EAAmC;EACjC,QAAIwC,KAAK,CAACzB,GAAN,CAAUD,GAAV,CAAJ,EAAoB;EAClB,aAAO0B,KAAK,CAACvB,GAAN,CAAaH,GAAb,CAAP;EACD,KAFD,MAEO;EACL0B,MAAAA,KAAK,CAACW,gBAAN,CAA4CrC,GAA5C,EAAiDd,KAAjD;EACA,aAAOwC,KAAK,CAACvB,GAAN,CAAaH,GAAb,CAAP;EACD;EACF,GAR0B,EAS3B,CAACA,GAAD,CAT2B,CAA7B;EAYA,MAAMuD,QAAQ,GAAGD,iBAAW,CAC1B,UAACtB,QAAD,EAAmC;EACjCN,IAAAA,KAAK,CAACtB,GAAN,CAA+BJ,GAA/B,EAAoCgC,QAApC;EACD,GAHyB,EAI1B,CAAChC,GAAD,CAJ0B,CAA5B;;EAOA,kBAAwCwD,cAAQ,CAAIH,SAAS,CAACD,YAAD,CAAb,CAAhD;EAAA,MAAOK,YAAP;EAAA,MAAqBC,eAArB;;EAEAC,EAAAA,mBAAa,CAACN,SAAS,CAACD,YAAD,CAAV,CAAb;EAEAP,EAAAA,yBAAyB,CAAC,YAAM;EAC9B,QAAMe,KAAK,GAAGlC,KAAK,CAACpC,SAAN,CAAgBU,GAAhB,EAAqB,YAAM;EACvC0D,MAAAA,eAAe,CAAChC,KAAK,CAACvB,GAAN,CAAUH,GAAV,CAAD,CAAf;EACD,KAFa,CAAd;EAIA,WAAO4D,KAAP;EACD,GANwB,EAMtB,CAACR,YAAD,EAAepD,GAAf,CANsB,CAAzB;EAQA,SAAO,CAACyD,YAAD,EAAeF,QAAf,CAAP;EACD;EAEDJ,UAAU,CAACU,WAAX,GAAyB,YAAzB;;ECvCO,SAASC,aAAT,CAA0B9D,GAA1B,EAA0CoD,YAA1C,EAA8E;EACnF1B,EAAAA,KAAK,CAACW,gBAAN,CAAuBrC,GAAvB,EAA4BoD,YAA5B;EACA,SAAO,SAASW,oBAAT,GAA2E;EAChF,WAAOZ,UAAU,CAAInD,GAAJ,CAAjB;EACD,GAFD;EAGD;;ECPM,SAASgE,qBAAT,CAAkChE,GAAlC,EAAkD;EACvD,SAAO,UAACd,KAAD;EAAA,WAAgCwC,KAAK,CAACtB,GAAN,CAAUJ,GAAV,EAAed,KAAf,CAAhC;EAAA,GAAP;EACD;;ECAM,SAAS+E,mBAAT,CAAgCjE,GAAhC,EAAgD;EACrD,SAAO,SAASkE,gBAAT,GAA4B;EACjC,oBAAwCV,cAAQ,CAAI9B,KAAK,CAACvB,GAAN,CAAUH,GAAV,CAAJ,CAAhD;EAAA,QAAOyD,YAAP;EAAA,QAAqBC,eAArB;;EAEAC,IAAAA,mBAAa,CAACF,YAAD,CAAb;EAEAZ,IAAAA,yBAAyB,CAAC,YAAM;EAC9B,UAAMe,KAAK,GAAGlC,KAAK,CAACpC,SAAN,CAAgBU,GAAhB,EAAqB,YAAM;EACvC0D,QAAAA,eAAe,CAAChC,KAAK,CAACvB,GAAN,CAAUH,GAAV,CAAD,CAAf;EACD,OAFa,CAAd;EAIA,aAAO4D,KAAP;EACD,KANwB,EAMtB,CAAC5D,GAAD,CANsB,CAAzB;EAQA,WAAOyD,YAAP;EACD,GAdD;EAeD;;ECDD;EACA;EACA;EACA;EACA;EACA;EACA;MACaU,oBAAoB,GAAG,SAAvBA,oBAAuB,CAClC9F,IADkC,EAElC+E,YAFkC,EAGlCgB,YAHkC,EAIiC;EAAA;;EACnE,MAAI,CAAC/F,IAAL,EAAW,MAAM,IAAIgG,KAAJ,CAAU,kBAAV,CAAN;EACX,MAAI,OAAOhG,IAAP,KAAgB,QAApB,EAA8B,MAAM,IAAIgG,KAAJ,CAAU,0BAAV,CAAN;EAE9B,MAAMC,eAAe,GAAGjG,IAAI,CAACkG,MAAL,CAAY,CAAZ,EAAeC,WAAf,KAA+BnG,IAAI,CAACF,KAAL,CAAW,CAAX,CAAvD;EAEA,MAAMsG,GAAG,GAAGX,aAAa,CAAIzF,IAAJ,EAAU+E,YAAV,CAAzB;EACA,MAAMsB,SAAS,GAAGT,mBAAmB,CAAI5F,IAAJ,CAArC;EACA,MAAMsG,QAAQ,GAAGX,qBAAqB,CAAI3F,IAAJ,CAAtC;EACA,MAAM8B,GAAG,GAAGyC,gBAAgB,CAAIvE,IAAJ,CAA5B;EACA,MAAI+F,YAAJ,EAAkBzB,sBAAsB,CAACtE,IAAD,EAAO+F,YAAY,CAAClF,KAApB,CAAtB;EAElB,MAAM0F,OAAO,oCACJN,eADI,IACgBG,GADhB,mBAEJH,eAFI,eAEsBI,SAFtB,wBAGCJ,eAHD,IAGqBK,QAHrB,mBAIJL,eAJI,IAIgBnE,GAJhB,qBAKFmE,eALE,IAKkB;EAAA;;EAAA,WAAMK,QAAQ,wBAACP,YAAD,oBAACA,YAAY,CAAElF,KAAf,kCAAwBkE,YAAxB,CAAd;EAAA,GALlB,WAAb;EAQA,SAAOwB,OAAP;EACD;;MCjDYC,eAAe,GAAG,SAAlBA,eAAkB,CAAC7H,QAAD,EAAmB8H,YAAnB,EAAiD;EAC9EA,EAAAA,YAAY,CAACtC,OAAb,CAAqB,UAACuC,UAAD;EAAA,WAAgBrD,KAAK,CAACpC,SAAN,CAAgByF,UAAhB,EAA4B/H,QAA5B,CAAhB;EAAA,GAArB;EACD;;ECLD,IAAI2D,cAAc,GAAG5C,MAAM,CAACC,SAAP,CAAiB2C,cAAtC;;EAEA,SAASqE,EAAT,CAAYC,CAAZ,EAAwBC,CAAxB,EAAoC;EAClC,MAAID,CAAC,KAAKC,CAAV,EAAa;EACX,WAAOD,CAAC,KAAK,CAAN,IAAWC,CAAC,KAAK,CAAjB,IAAsB,IAAID,CAAJ,KAAU,IAAIC,CAA3C;EACD,GAFD,MAEO;EACL,WAAOD,CAAC,KAAKA,CAAN,IAAWC,CAAC,KAAKA,CAAxB;EACD;EACF;;EAEM,SAASC,YAAT,CAAsBC,IAAtB,EAAiCC,IAAjC,EAA4C;EACjD,MAAIL,EAAE,CAACI,IAAD,EAAOC,IAAP,CAAN,EAAoB;EAClB,WAAO,IAAP;EACD;;EAED,MAAI,OAAOD,IAAP,KAAgB,QAAhB,IAA4BA,IAAI,KAAK,IAArC,IAA6C,OAAOC,IAAP,KAAgB,QAA7D,IAAyEA,IAAI,KAAK,IAAtF,EAA4F;EAC1F,WAAO,KAAP;EACD;;EAED,MAAMC,KAAK,GAAGvH,MAAM,CAAC4D,IAAP,CAAYyD,IAAZ,CAAd;EACA,MAAMG,KAAK,GAAGxH,MAAM,CAAC4D,IAAP,CAAY0D,IAAZ,CAAd;EAEA,MAAIC,KAAK,CAAChI,MAAN,KAAiBiI,KAAK,CAACjI,MAA3B,EAAmC,OAAO,KAAP;;EAEnC,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+H,KAAK,CAAChI,MAA1B,EAAkCC,CAAC,EAAnC,EAAuC;EACrC,QAAI,CAACoD,cAAc,CAACzC,IAAf,CAAoBmH,IAApB,EAA0BC,KAAK,CAAC/H,CAAD,CAA/B,CAAD,IAAkD,CAACyH,EAAE,CAACI,IAAI,CAACE,KAAK,CAAC/H,CAAD,CAAN,CAAL,EAA2B8H,IAAI,CAACC,KAAK,CAAC/H,CAAD,CAAN,CAA/B,CAAzD,EAA+G;EAC7G,aAAO,KAAP;EACD;EACF;;EAED,SAAO,IAAP;EACD;;ECzBM,SAASiI,kBAAT,CAAsCC,QAAtC,EAAgEC,QAAhE,EAA4F;EAAA,MAA5BA,QAA4B;EAA5BA,IAAAA,QAA4B,GAAjBP,YAAiB;EAAA;;EACjG,kBAA0C3B,cAAQ,CAAI9B,KAAK,CAACE,OAAN,CAAc6D,QAAd,CAAJ,CAAlD;EAAA,MAAOE,aAAP;EAAA,MAAsBC,gBAAtB;;EAEAjC,EAAAA,mBAAa,CAACgC,aAAD,CAAb;EAEA9C,EAAAA,yBAAyB,CAAC,YAAM;EAC9B,QAAMe,KAAK,GAAGlC,KAAK,CAACY,iBAAN,CAAwB,UAAC1C,SAAD,EAAeC,QAAf,EAA+B;EACnE,UAAMgG,aAAa,GAAGJ,QAAQ,CAAC7F,SAAD,CAA9B;EACA,UAAMkG,YAAY,GAAGL,QAAQ,CAAC5F,QAAD,CAA7B;;EACA,UAAI,CAAC6F,QAAQ,CAACG,aAAD,EAAgBC,YAAhB,CAAb,EAA4C;EAC1CF,QAAAA,gBAAgB,CAACE,YAAD,CAAhB;EACD;EACF,KANa,CAAd;EAQA,WAAOlC,KAAP;EACD,GAVwB,EAUtB,CAAC6B,QAAD,CAVsB,CAAzB;EAYA,SAAOE,aAAP;EACD;;;;;;;;;;;;;;;;;;;"}